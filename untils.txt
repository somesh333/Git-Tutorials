untility function for version 3